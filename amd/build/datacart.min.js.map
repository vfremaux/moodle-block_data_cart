{"version":3,"file":"datacart.min.js","sources":["../src/datacart.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Javascript controller for controlling the sections.\r\n *\r\n * @module     block_multicourse_navigation/collapse_control\r\n * @package    block_multicourse_navigation\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n// jshint unused: true, undef:true\r\ndefine(['jquery', 'core/log', 'core/config'], function ($, log, cfg) {\r\n\r\n    var datacart = {\r\n\r\n        blockid: 0,\r\n\r\n        init: function (params) {\r\n            datacart.blockid = params[0];\r\n            // Use defered binding.\r\n            $('.datacart-list').on('click', '.datacart-delete', this.remove_record);\r\n            $('.datacart-list').on('click', '#datacart-reset', this.reset_list);\r\n\r\n            log.debug(\"AMD block data cart \" + datacart.blockid + \" initialized !\")\r\n        },\r\n\r\n        /**\r\n         * This function is called from an event handler\r\n         * @see cvtheque.js in data_behaviour\r\n         */\r\n        add_record: function (recordid) {\r\n\r\n            var url = cfg.wwwroot + '/blocks/data_cart/ajax/service.php';\r\n            url += '?what=addrecord';\r\n            url += '&blockid=' + datacart.blockid;\r\n            url += '&recordid=' + recordid;\r\n\r\n            $.get(url);\r\n\r\n            datacart.reload_list();\r\n        },\r\n\r\n        /**\r\n         * This function is attached to delete buttons in datacart list.\r\n         */\r\n        remove_record: function (e) {\r\n            e.preventDefault();\r\n\r\n            var that, url;\r\n            that = $(this);\r\n\r\n            url = cfg.wwwroot + '/blocks/data_cart/ajax/service.php';\r\n            url += '?what=removerecord';\r\n            url += '&blockid=' + datacart.blockid;\r\n            url += '&recordid=' + that.attr('data-recordid');\r\n\r\n            $.get(url);\r\n\r\n            datacart.reload_list();\r\n        },\r\n\r\n        /**\r\n         * This function is attached to reset buttons in datacart list.\r\n         * Will reset cart for the current user.\r\n         */\r\n        reset_list: function (e) {\r\n            e.preventDefault();\r\n\r\n            var that, url;\r\n            that = $(this);\r\n\r\n            url = cfg.wwwroot + '/blocks/data_cart/ajax/service.php';\r\n            url += '?what=reset';\r\n            url += '&blockid=' + datacart.blockid;\r\n\r\n            $.get(url);\r\n\r\n            datacart.reload_list();\r\n        },\r\n\r\n        reload_list: function() {\r\n\r\n            var url = cfg.wwwroot + '/blocks/data_cart/ajax/service.php';\r\n            url += '?what=reload';\r\n            url += '&blockid=' + datacart.blockid;\r\n\r\n            $.get(url, function(data) {\r\n                $('#listcontent-block-' + datacart.blockid).html(data);\r\n            }, 'html');\r\n        }\r\n\r\n    };\r\n\r\n    return datacart;\r\n});\r\n\r\n"],"names":["define","$","log","cfg","datacart","blockid","init","params","on","this","remove_record","reset_list","debug","add_record","recordid","url","wwwroot","get","reload_list","e","that","preventDefault","attr","data","html"],"mappings":";;;;;;;AAuBAA,kCAAO,CAAC,SAAU,WAAY,gBAAgB,SAAUC,EAAGC,IAAKC,SAExDC,SAAW,CAEXC,QAAS,EAETC,KAAM,SAAUC,QACZH,SAASC,QAAUE,OAAO,GAE1BN,EAAE,kBAAkBO,GAAG,QAAS,mBAAoBC,KAAKC,eACzDT,EAAE,kBAAkBO,GAAG,QAAS,kBAAmBC,KAAKE,YAExDT,IAAIU,MAAM,uBAAyBR,SAASC,QAAU,mBAO1DQ,WAAY,SAAUC,cAEdC,IAAMZ,IAAIa,QAAU,qCACxBD,KAAO,kBACPA,KAAO,YAAcX,SAASC,QAC9BU,KAAO,aAAeD,SAEtBb,EAAEgB,IAAIF,KAENX,SAASc,eAMbR,cAAe,SAAUS,OAGjBC,KAAML,IAFVI,EAAEE,iBAGFD,KAAOnB,EAAEQ,MAETM,IAAMZ,IAAIa,QAAU,qCACpBD,KAAO,qBACPA,KAAO,YAAcX,SAASC,QAC9BU,KAAO,aAAeK,KAAKE,KAAK,iBAEhCrB,EAAEgB,IAAIF,KAENX,SAASc,eAObP,WAAY,SAAUQ,OAGRJ,IAFVI,EAAEE,iBAGKpB,EAAEQ,MAETM,IAAMZ,IAAIa,QAAU,qCACpBD,KAAO,cACPA,KAAO,YAAcX,SAASC,QAE9BJ,EAAEgB,IAAIF,KAENX,SAASc,eAGbA,YAAa,eAELH,IAAMZ,IAAIa,QAAU,qCACxBD,KAAO,eACPA,KAAO,YAAcX,SAASC,QAE9BJ,EAAEgB,IAAIF,KAAK,SAASQ,MAChBtB,EAAE,sBAAwBG,SAASC,SAASmB,KAAKD,QAClD,iBAKJnB,QACV"}